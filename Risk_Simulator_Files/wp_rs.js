var $jq=jQuery.noConflict();function isAllValues(e){var t;if(13==e.keyCode){if(!($jq("#avgL").val()&&$jq("#avgW").val()&&$jq("#winP").val()))return!1;drawChart(),document.getElementById("calc").click()}}function addChangeListen(){document.getElementById("ChangeSHR").addEventListener("click",(function(){dataRerunHR(!1)})),document.getElementById("RerunHR").addEventListener("click",(function(){dataRerunHR(!0)})),document.getElementById("ChangeSR").addEventListener("click",(function(){dataRerunRisk(!1)})),document.getElementById("RerunR").addEventListener("click",(function(){dataRerunRisk(!0)}))}function addFileListen(){var e=document.querySelector(".input-file"),t=document.querySelector(".input-file-trigger"),a=document.querySelector(".file-return");t.addEventListener("keydown",(function(t){13!=t.keyCode&&32!=t.keyCode||e.focus()})),t.addEventListener("click",(function(t){return e.focus(),!1})),e.addEventListener("change",(function(e){a.innerHTML=this.value}))}$jq("#calc").click((function(){$jq([document.documentElement,document.body]).animate({scrollTop:$jq("#mainGraph").offset().top},1e3)})),document.addEventListener("keydown",isAllValues,!1),$jq("#percentageCheck, #rMultiplesCheck, #fileCheck, #manualCheck").click((function(){changeInputs()})),document.getElementById("calc").addEventListener("click",(function(){drawChart()}));var maxDD=0,Result=0,avgDD=0,lossStrike=0,winStrike=0,maxAbsDD=0,avgAbsDD=0,Highest=0;var results=[],drawD=[];var csv,csvs;var rrN=[.1,.25,.5,.75,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5,6,10];var equ,avgL,avgW,hr,runs,sr,trades,pg,md,pf,step,start,probT,isFile,stdL,stdW,diffR,diffHR,standardD,rfr;var sc=parseFloat($jq("#startC").val().replace(/,/g,""));function removeInputs(){$jq(".mainOut").empty(),$jq(".textOut").empty(),$jq("#canvas").remove(),$jq("#mainGraph").html('<canvas id="canvas" />'),$jq("#canvas2").remove(),$jq("#graph1").html('<div class="restC"><canvas id="canvas2" /></div>'),$jq("#canvas3").remove(),$jq("#graph2").html('<div class="restC"><canvas id="canvas3" /></div>'),$jq("#pie1").remove(),$jq("#graph3").html('<div class="restC"><canvas id="pie1" /></div>'),$jq("#pie2").remove(),$jq("#graph4").html('<div class="restC"><canvas id="pie2" /></div>'),$jq("#scatter").remove(),$jq("#extraGraphs").append('<canvas id="scatter" />'),$jq("#canvas4").remove(),$jq("#extraGraphs").append('<canvas id="canvas4" />')}function returnInputs(){$jq(".entrys")&&$jq(".entrys").html('<table><tr><td><label for="averageLoss" class="label-main-inp">Average Loss <a class="tooltip-rs"><div class="isBG"/></div><span>The average losing trade of your trading system (geometric, weighted and other averages can be used too).</span></a></label><div class="flex" id="I"><span class="ip"><span class="pc">%</span></span><input type="number" id="avgL" name="averageLoss" /></div></td><td><label for="averageWin" class="label-main-inp">Average Win <a class="tooltip-rs"><div class="isBG"/></div><span>The average winning trade of your trading system (geometric, weighted and other averages can be used too).</span></a></label><div class="flex" id="I"><span class="ip"><span class="pc">%</span></span><input type="number" id="avgW" name="averageWin" /></div></td><td><label for="winningP" class="label-main-inp">Hitrate <a class="tooltip-rs"><div class="isBG"/></div><span>The percentage of your winning trades from all trades. Example: 45 out of 100 trades are winners --> 45% hitrate.</span></a></label><div class="flex" id="I"><span class="ip">%</span><input type="number" id="winP" name="winningP" /></div></td><td><input class="calcButton" id="calc" type="button" value="CALCULATE" /></td></tr></table>')}function addSC(){$jq("#startCapital").is(":empty")&&$jq("#startCapital").html('<label for="sC">Starting Capital <a class="tooltip-rs"><div class="isBG"/></div><span>Starting Capital, where the calculations are based on. Note: more trades mean there are compounded effects in the results.</span></a></label><div class="flex" id="NI"><span class="ip">$</span><input data-type="currency" type="text" id="startC" name="sC" value="100,000.00" /></div>')}function changeInputs(){if($jq(".entrys").empty(),removeInputs(),$jq("#fileCheck").is(":checked")){switchSTD_Display(!1);let e='<form id="upForm" action="#"><div class="input-file-container"><input class="input-file" id="my-file" type="file"><label tabindex="0" for="my-file" class="input-file-trigger">Upload .csv/.txt</label></div><p class="file-return"></p></form>';$jq("#percentageCheck").is(":checked")&&(e='<form id="upForm" action="#"><div class="input-file-container"><input class="input-file" id="my-file" type="file"><label tabindex="0" for="my-file" class="input-file-trigger">Upload .csv/.txt</label></div><p class="file-return"></p><p style="margin-bottom: 20px; max-width: 200px; margin-left: 35px;" class="text-center">Scientific notation e.g. 0.01 for 1% expected</p></form>'),$jq("#uploadFile").html(e),$jq(".entrys").html('<table><tr><td><input class="calcButton" id="calc" type="button" value="CALCULATE" /></td></tr></table>'),addFileListen(),$jq("#percentageCheck").is(":checked")?(addSC(),$jq(".pc").html("%"),parseCsv=new uploadDealcsv,addCSVEL(),parseCsv.getCsv()):($jq("#startCapital").empty(),$jq(".pc").html("R"),parseCsv=new uploadDealcsv,addCSVEL(),parseCsv.getCsv())}else switchSTD_Display(!0),$jq("#uploadFile").empty(),returnInputs(),$jq("#percentageCheck").is(":checked")?(addSC(),$jq(".pc").html("%")):($jq("#startCapital").empty(),$jq(".pc").html("R"));document.getElementById("calc").addEventListener("click",(function(){drawChart()}))}function switchSTD_Display(e){let t=document.getElementById("stDs");let a=document.getElementById;t.style.display=e?"block":"none"}function dataSet(e){let t=[];t[0]=sc;let a=sc;let r=sc;e?equ=sc:(equ=0,a=0,r=0);let n=0,s=0;let i=0;let o=0;let l=[];let d=[];for(let c=0;c<trades;c++){let u=e?nextTrade(equ)+equ:nextTradeR()+equ;if(t[c+1]=u,u>a&&(a=u),e?(a-u)/a>n&&(n=(a-u)/a):a-u>n&&(n=a-u),u<r&&(r=u),u>equ?(i=0,o++,l.push(o)):(o=0,i++,d.push(i)),equ=u,c==trades-1){a>Highest&&(Highest=a),e?(Result+=(equ-sc)/sc,results.push((equ-sc)/sc*100),drawD.push(100*n),s=(sc-r)/sc):(Result+=equ,results.push(equ),drawD.push(n),s=Math.abs(r)),avgDD+=n,avgAbsDD+=s,n>maxDD&&(maxDD=n),s>maxAbsDD&&(maxAbsDD=s);let t=Math.max(...l);let i=Math.max(...d);t>winStrike&&(winStrike=t),i>lossStrike&&(lossStrike=i)}}return t}function dataSets(e){$jq("#fileCheck").is(":checked")||(stdL*=100,stdW*=100);let t=[];for(let a=0;a<sr;a++){let r=dataSet(e);if(a<runs){let e=randColor();let n={label:a.toString(),fill:!1,backgroundColor:e,borderColor:e,data:r};t.push(n)}}return t}function dataSetsR(){stdL*=100,stdW*=100;let e=[];for(let t=0;t<sr;t++){let a=dataSet(!0);if(t<runs){let r=randColor();let n={label:t.toString(),fill:!1,backgroundColor:r,borderColor:r,data:a};e.push(n)}}return e}function dataRerunHR(e){let t=(1+diffHR)*hr*100;isFile?(document.getElementById("manualCheck").checked=!0,changeInputs(),$jq("#winP").val(t.toFixed(2)),$jq("#avgW").val(avgW.toFixed(2)),$jq("#avgL").val(avgL.toFixed(2)),$jq("#maxDrawdown").val(md.toFixed(2)),$jq("#StdL").val(stdL.toFixed(2)),$jq("#StdW").val(stdW.toFixed(2)),$jq("#trades").val(trades),$jq("#percentageCheck").is(":checked")&&$jq("#startC").val(sc),$jq("SimR").val(sr),$jq("GraphL").val(runs),$jq("rFr").val(rfr),e&&drawChart()):($jq("#winP").val(t.toFixed(2)),e&&drawChart())}function dataRerunRisk(e){let t=avgW*(1-diffR/100);let a=avgL*(1-diffR/100);$jq("#percentageCheck").is(":checked")&&(t*=100,a*=100),isFile?(document.getElementById("manualCheck").checked=!0,changeInputs(),$jq("#winP").val((100*hr).toFixed(2)),$jq("#avgW").val(t.toFixed(2)),$jq("#avgL").val(a.toFixed(2)),$jq("#maxDrawdown").val(parseFloat(md).toFixed(2)),$jq("#trades").val(trades),$jq("#StdL").val(stdL.toFixed(2)),$jq("#StdW").val(stdW.toFixed(2)),$jq("#percentageCheck").is(":checked")&&$jq("#startC").val(sc),$jq("SimR").val(sr),$jq("GraphL").val(runs),$jq("rFr").val(rfr),e&&drawChart()):($jq("#avgW").val(t.toFixed(2)),$jq("#avgL").val(a.toFixed(2)),e&&drawChart())}function labels(){let e=[];for(let t=1;t<trades+1;t++)e[t]=t.toString();return e}function Results(){let e=[];let t=results.sort((function(e,t){return e>t?1:-1}));t=t.reverse();let a=sr/10;for(let r=t.length-a;r>=a;r-=a)e.push(t[r].toFixed(2));return e}function ResultsDD(e){let t=[];let a=drawD.sort((function(e,t){return e>t?1:-1}));a=a.reverse();let r=sr/10;if(e)return a[sr/100];for(let e=a.length-r;e>=r;e-=r)t.push(a[e].toFixed(2));return t}function countTo(e){let t=[];for(let a=1;a<e+1;a++)t.push(a.toString());return t}function run(e){nullify();let t="";let a=labels(),r;let n;return e?(t="Equity in $",r=dataSets(e)):(t="Equity in R",r=dataSets(e)),{type:"line",data:{labels:a,datasets:r},options:{elements:{point:{radius:0},line:{tension:0}},scales:{yAxes:[{gridLines:{display:!0,color:"rgba(255,255,255, 0.2)"},ticks:{fontSize:15,fontColor:"white"},scaleLabel:{display:!0,labelString:t,fontSize:13,fontColor:"white"}}],xAxes:[{gridLines:{display:!0,color:"rgba(255,255,255, 0.2)"},ticks:{fontColor:"white"}}]},events:["click"],legend:{display:!1},tooltips:{enabled:!1},responsive:!0,title:{display:!0,text:"Equity Curve Simulation",fontSize:17,fontColor:"white"}}}}function run4XY(e){let t=[];for(let e in probT[0])t.push([e,probT[0][e]]);t.sort((function(e,t){return e[1]-t[1]}));let a=[];let r=[];for(let e=0;e<t.length;e++)a.push((100*t[e][1]).toFixed(2)+"%"),r.push(t[e][0]);return e?a:r}function colorFill2C(e,t,a){let r=[];for(let n=0;n<a.length;n++)a[n]<0?r.push(t):r.push(e);return r}function run2(){let e="";let t;return e=$jq("#percentageCheck").is(":checked")?"Return in %":"Return in R",{type:"bar",data:{labels:["90%","80%","70%","60%","50%","40%","30%","20%","10%"],datasets:[{label:"Chance of reaching this goal",data:Results(),backgroundColor:"rgba(0, 204, 255, 0.9)",borderColor:"rgba(255, 255, 255, 0.9)",borderWidth:1}]},options:{scales:{yAxes:[{gridLines:{display:!0,color:"rgba(255,255,255, 0.2)"},ticks:{fontSize:15,fontColor:"white"},scaleLabel:{display:!0,labelString:e,fontSize:13,fontColor:"white"}}],xAxes:[{gridLines:{display:!0,color:"rgba(255,255,255, 0.2)"},ticks:{fontColor:"white"}}]},events:["click"],legend:{display:!1},responsive:!0,title:{display:!0,text:"Cumulative Return Probabilities",fontSize:17,fontColor:"white"}}}}function run3(){let e="";let t;return e=$jq("#percentageCheck").is(":checked")?"Drawdown in %":"Drawdown in R",{type:"bar",data:{labels:["90%","80%","70%","60%","50%","40%","30%","20%","10%"],datasets:[{label:"Chance of reaching this DD",data:ResultsDD(!1),backgroundColor:"rgba(255, 105, 51, 0.9)",borderColor:"rgba(255, 255, 255, 0.9)",borderWidth:1}]},options:{scales:{yAxes:[{gridLines:{display:!0,color:"rgba(255,255,255, 0.2)"},ticks:{fontSize:15,fontColor:"white"},scaleLabel:{display:!0,labelString:e,fontSize:13,fontColor:"white"}}],xAxes:[{gridLines:{display:!0,color:"rgba(255,255,255, 0.2)"},ticks:{fontColor:"white"}}]},events:["click"],legend:{display:!1},responsive:!0,title:{display:!0,text:"Cumulative Drawdown Probabilities",fontSize:17,fontColor:"white"}}}}function run4(){let e=run4XY(!1);let t;return{type:"bar",data:{labels:run4XY(!0),datasets:[{label:"Chance of reaching this R/R",data:e,backgroundColor:colorFill2C("rgba(36, 198, 0, 0.55)","rgba(255,51,51, 0.9)",e),borderColor:"rgba(255, 255, 255, 0.9)",borderWidth:1}]},options:{scales:{yAxes:[{gridLines:{display:!0,color:"rgba(255,255,255, 0.2)"},ticks:{fontSize:15,fontColor:"white"},scaleLabel:{display:!0,labelString:"Risk / Reward",fontSize:13,fontColor:"white"}}],xAxes:[{gridLines:{display:!0,color:"rgba(255,255,255, 0.2)"},ticks:{fontColor:"white"}}]},events:["click"],legend:{display:!1},tooltips:{enabled:!1},responsive:!0,title:{display:!0,text:"Risk / Reward Probabilities",fontSize:17,fontColor:"white"}}}}function pieRR(e){let t=avgW,a=avgL;return e||(t*=100,a*=100),isFile&&$jq("#percentageCheck").is(":checked")&&(t/=100,a/=100),{type:"pie",data:{datasets:[{data:[t.toFixed(2),a.toFixed(2)],backgroundColor:["rgba(0, 204, 255, 0.9)","rgba(255, 105, 51, 0.9)"],hoverBackgroundColor:["rgba(0, 204, 255, 0.9)","rgba(255, 105, 51, 0.9)"],label:"W/L Ratio"}],labels:["Average Win","Average Loss"]},options:{responsive:!0,legend:{display:!0,labels:{fontColor:"white",fontSize:15}},tooltips:{callbacks:{label:function(t,a){let r=a.datasets[t.datasetIndex];let n=r.data.reduce((function(e,t,a,r){return e+t}));let s;return r.data[t.index]+(e?" R":"%")}}}}}}function pieWL(){let e,t=100*(1-hr);return{type:"pie",data:{datasets:[{data:[(100*hr).toFixed(2),t.toFixed(2)],backgroundColor:["rgba(0, 204, 255, 0.9)","rgba(255, 105, 51, 0.9)"],hoverBackgroundColor:["rgba(0, 204, 255, 0.9)","rgba(255, 105, 51, 0.9)"],label:"Win/Loss"}],labels:["Winning Trades","Losing Trades"]},options:{responsive:!0,legend:{display:!0,labels:{fontColor:"white",fontSize:15}},tooltips:{callbacks:{label:function(e,t){let a=t.datasets[e.datasetIndex];let r=a.data.reduce((function(e,t,a,r){return e+t}));let n;return a.data[e.index]+"%"}}}}}}function scatterData(e,t){let a=[];let r=[];for(let n=0;n<t;n++){if(e){let e=nextTradeR();r.push({x:n,y:e}),a.push(e)}else{let e=nextTrade(sc);r.push({x:n,y:e}),a.push(e)}e?r.push({x:n,y:nextTradeR()}):r.push({x:n,y:nextTrade(sc)})}return[r,a]}function scatter(e){let t="";t=e?"Trade Result in R":"Trade Result in $";let a=scatterData(e,300);let r;return standardD=stD(a[1],average(a[1])),{type:"scatter",data:{datasets:[{label:"Profit",data:a[0],pointBackgroundColor:"yellow"}]},options:{zeroLineColor:"#FFFDE7",scales:{yAxes:[{gridLines:{zeroLineColor:"white",display:!0,color:"rgba(255,255,255, 0.2)"},ticks:{fontSize:15,fontColor:"white"},scaleLabel:{display:!0,labelString:t,fontSize:13,fontColor:"white"}}],xAxes:[{gridLines:{display:!0,color:"rgba(255,255,255, 0.2)"},ticks:{fontColor:"white"}}]},events:["click"],legend:{display:!1},tooltips:{enabled:!1},responsive:!0,title:{display:!0,text:"Return Distribution",fontSize:17,fontColor:"white"}}}}function nullify(){drawD=[],results=[],maxDD=0,Result=0,avgDD=0,lossStrike=0,winStrike=0,maxAbsDD=0,avgAbsDD=0,Highest=0}function createCSVValues(){let e=[];var t=0,a=0;let r=[];let n=[];for(let s=0;s<csv.length;s++){let i=parseFloat(removeNonNumber(csv[s]));isNaN(i)||(i<a&&(a=i),i>t&&(t=i),e.push(i),i>0?r.push(i):i<0&&n.push(i))}return step=(t-a)/60,start=a,avgW=100*average(r),avgL=100*-average(n),stdW=100*stD(r,avgW),stdL=100*stD(n,avgL),avgL/=100,avgW/=100,stdL/=100,stdW/=100,console.log("down here avgW",avgW,"avgL",avgL,stdW,stdL),e}function createStepTable(e){let t=[];t.push(e);for(let e=1;e<61;e++)t.push(t[e-1]+step);return t}function createProbTable(e,t){let a={};let r={};let n={};let s={};let i=0;let o=0;for(let e=0;e<t.length;e++)n[t[e]]=0;for(let a=0;a<e.length;a++){let r=closest(e[a],t);r>0?i++:o++,n[r]+=1}let l=0,d=0;for(const t in n){let c;if(n[t]>0){if(t>0){let e=l+n[t]/i;a[parseFloat(e)]=t,l=e}else{let e=d+n[t]/o;r[parseFloat(e)]=t,d=e}s[t]=n[t]/e.length}}let c;let u;return[s,sortObject(a),sortObject(r)]}function HR(e){let t=0;for(let a in e)e[a]>0&&t++;return t/e.length}function weightedPN(e){let t=0;let a=0;let r=0;let n=0;for(let s in e)s>0?(t+=s*e[s],r+=e[s]):(a+=s*e[s],n+=e[s]);return[t/r,a/n]}function nextTradeR(){return Math.random()<hr?randomTR(parseFloat(avgW),stdW):parseFloat(randomTR(-avgL,stdL))}let ausg=!1;function nextTrade(e){return ausg||(console.log("avgW",avgW,"avgL",avgL,"stdW",stdW,"stdL",stdL,"HR",hr),ausg=!0),Math.random()<hr?e*randomTR(avgW,stdW):e*randomTR(-avgL,stdL)}function closest(e,t){let a;return t.reduce((function(t,a){return Math.abs(a-e)<Math.abs(t-e)?a:t}))}function removeNonNumber(e){return/[eE]/g.test(e)?0:e.toString().replace(/[^0-9.-]/g,"")}let iCounter=0;function findMatch(e,t){iCounter<10&&console.log("Probtable:",e,"RandomValue:",t),iCounter++;let a=e[0].key;for(let r in e){let n;if(a=e[r].key,t<e[r].value)return iCounter<10&&console.log(parseFloat(a)),parseFloat(a)}}function sortObject(e){var t=[];var a;for(a in e)e.hasOwnProperty(a)&&t.push({value:a,key:e[a]});return t.sort((function(e,t){return e.value-t.value})),t}function numberWithCommas(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function displayD(e){return numberWithCommas((e/100*sc).toFixed(2))}function drawChart(){$jq(".mainOut").length>0&&$jq(".mainOut").empty(),$jq(".textOut").empty(),isFile=!1,document.getElementById("fileCheck").checked?isFile=!0:(avgL=Math.abs(parseFloat(document.getElementById("avgL").value)),avgW=parseFloat(document.getElementById("avgW").value),hr=parseFloat(document.getElementById("winP").value/100),stdL=parseFloat(document.getElementById("StdL").value/100*avgL),stdW=parseFloat(document.getElementById("StdW").value/100*avgW)),trades=parseFloat(document.getElementById("trades").value.replace(/,/g,"")),md=parseFloat(document.getElementById("maxDrawdown").value),sr=parseFloat(document.getElementById("SimR").value.replace(/,/g,"")),runs=parseFloat(document.getElementById("GraphL").value),rfr=parseFloat(document.getElementById("rFr").value),document.getElementById("percentageCheck").checked?(isFile||(avgL/=100,avgW/=100,stdL/=100,stdW/=100),isFile&&calcFileV(),pf=Math.round(avgW*hr/(avgL*(1-hr))*100)/100,sc=parseFloat($jq("#startC").val().replace(/,/g,"")),0===avgL||0===avgW||0===hr||0===trades||0===sc?outPutNeg():outPuts()):(sc=0,isFile&&calcFileV(),pf=Math.round(avgW*hr/(avgL*(1-hr))*100)/100,0===avgL||0===avgW||0===hr||0===trades?outPutNeg():outPutsR())}function calcFileV(){hr=HR(csvs)}function createBlock(e,t,a){$jq(".mainOut").append('<div class="Block"><div class="Heading">'+e+' <a class="tooltip-rs"><div class="isBG"></div><span>'+t+"</span></a>"+'</div><div class="Output">'+a+"</div></div>")}function outPutsR(){var e=document.getElementById("canvas").getContext("2d");window.myLine=new Chart(e,run(!1));var t=document.getElementById("canvas2").getContext("2d");window.myLine=new Chart(t,run2());var a=document.getElementById("canvas3").getContext("2d");window.myLine=new Chart(a,run3());var r=document.getElementById("scatter").getContext("2d");window.myLine=new Chart(r,scatter(!0));var n=document.getElementById("pie1").getContext("2d");window.myLine=new Chart(n,pieWL());var s=document.getElementById("pie2").getContext("2d");if(window.myLine=new Chart(s,pieRR(!0)),isFile){var i=document.getElementById("canvas4").getContext("2d");window.myLine=new Chart(i,run4())}let o=Result/sr;let l=avgW/avgL*hr-(1-hr);let d=ResultsDD(!0);let c=o/d;let u=(o-rfr)/standardD;if(createBlock("Profit Factor","Profit Factor with the formula: (Avg Win * Hitrate) / (Avg Loss Positive * (1 - Hitrate)).",pf),createBlock("Expectancy","What the system can expect to make per trade in R. Formula: (Avg Win / Avg Loss) * Hitrate - (1 - Hitrate)",l.toFixed(2)),createBlock("Sharp Ratio","The sharp ratio shows you the excess return vs the risk free return divided by the volatility of the trading system. You can specify the risk free rate in the settings.",u.toFixed(2)),createBlock("Highest Rel. DD","The highest drawdown in R from all simulator runs relative to the equity high.",maxDD.toFixed(2)+" R"),createBlock("Average DD","Average maximum drawdown of each simulator run. Around 50% of results will have this drawdown.",(avgDD/sr).toFixed(2)+" R"),createBlock("Highest Absolute DD","Highest drawdown of all simulator runs relative to the starting point at 0 R.",maxAbsDD.toFixed(2)+" R"),createBlock("Average Absolute DD","Drawdown that you will get in 50% of cases relative to the starting point at 0 R.",(avgAbsDD/sr).toFixed(2)+" R"),createBlock("Expected DD","The drawdown that has a 1% chance to happen. Anything under 1% is very unlikely.",d.toFixed(2)+" R"),createBlock("Average Profit","Average profit in R from all simulator runs after "+trades+" trades.",o.toFixed(2)+" R"),createBlock("G/D Ratio","Gain to drawdown ratio. Average profit / Expected DD",c.toFixed(2)),createBlock("Max Loss Strike","Maximum consecutive losers in all simulator runs.",lossStrike),createBlock("Max Win Strike","Maximum consecutive winners in all simulator runs.",winStrike),isFile&&(createBlock("Average Win","The weighted average of all profit trades in the uploaded trade list.",avgW.toFixed(2)+" R"),createBlock("Average Loss","The weighted average of all loss trades in the uploaded trade list.",avgL.toFixed(2)+" R"),createBlock("Hitrate","Hitrate, based on the trades in your file. Winning trades / Sum of trades.",(100*hr).toFixed(2)+"%"),createBlock("StD Loss Trades","Standard deviation of loss trades in the uploaded trade list. The higher the more diverging the positive trade results.",stdL.toFixed(2)+"%"),createBlock("StD Profit Trades","Standard deviation of profit trades in the uploaded trade list. The higher the more diverging the negative trade results.",stdW.toFixed(2)+"%")),md>0)if(Math.floor(maxDD)-1>md){let e;let t=avgL*(md/maxDD)*100;diffR=100*(100*avgL-t)/(100*avgL),t/=100;let a=nHR(md/avgL,avgW/avgL);diffHR=Math.abs(100*hr-a)/hr/100,a=hr*(1+diffHR),textOutSugg(100*a),addChangeListen()}else $jq(".textOut").empty(),$jq(".textOut").append("You won't exceed your maximum drawdown!")}function outPuts(){var e=document.getElementById("canvas").getContext("2d");window.myLine=new Chart(e,run(!0));var t=document.getElementById("canvas2").getContext("2d");window.myLine=new Chart(t,run2());var a=document.getElementById("canvas3").getContext("2d");window.myLine=new Chart(a,run3());var r=document.getElementById("scatter").getContext("2d");window.myLine=new Chart(r,scatter(!1));var n=document.getElementById("pie1").getContext("2d");window.myLine=new Chart(n,pieWL());var s=document.getElementById("pie2").getContext("2d");if(window.myLine=new Chart(s,pieRR(!1)),isFile){var i=document.getElementById("canvas4").getContext("2d");window.myLine=new Chart(i,run4())}let o=Math.round(1e4*maxDD)/100;let l=avgDD/sr*100;let d=Result/sr*100;let c=avgW/avgL*hr-(1-hr);let u=ResultsDD(!0);let g=Math.round(d/u*100)/100;let p=(d-rfr)/(standardD/sc*100);if(createBlock("Profit Factor","Profit Factor with the formula: (Avg Win * Hitrate) / (Avg Loss Positive * (1 - Hitrate)).",pf),createBlock("Expectancy","What the system can expect to make per trade in %. Formula: (Avg Win / Avg Loss) * Hitrate - (1 - Hitrate)",c.toFixed(2)),createBlock("Sharp Ratio","The sharp ratio shows you the excess return vs the risk free return divided by the volatility of the trading system. You can specify the risk free rate in the settings.",p.toFixed(2)),createBlock("Highest Rel. DD","The highest drawdown in percentage from all simulator runs relative to the equity high.",(100*maxDD).toFixed(2)+'%<p><span style="font-size: 12px;">($'+displayD(100*maxDD)+")</span></p>"),createBlock("Average DD","Average maximum drawdown of each simulator run. Around 50% of results will have this drawdown. ",(avgDD/sr*100).toFixed(2)+'%<p><span style="font-size: 12px;">($'+displayD(avgDD/sr*100)+")</span></p>"),createBlock("Highest Absolute DD","Highest drawdown of all simulator runs relative to the starting capital of $"+sc+". ",(100*maxAbsDD).toFixed(2)+'%<p><span style="font-size: 12px;">($'+displayD(100*maxAbsDD)+")</span></p>"),createBlock("Average Absolute DD","Drawdown that you will get in 50% of cases relative to the starting capital of $"+sc+".",(avgAbsDD/sr*100).toFixed(2)+'%<p><span style="font-size: 12px;">($'+displayD(avgAbsDD/sr*100)+")</span></p>"),createBlock("Expected DD","The drawdown that has a 1% chance to happen. Anything under 1% is very unlikely.",u.toFixed(2)+'%<p><span style="font-size: 12px;">($'+displayD(u)+")</span></p>"),createBlock("Average Profit","Average profit in percentages from all simulator runs after "+trades+" trades.",d.toFixed(2)+'%<p><span style="font-size: 12px;">($'+displayD(d)+")</span></p>"),createBlock("G/D Ratio","Gain to drawdown ratio. Average profit / Expected DD",g),createBlock("Max Loss Strike","Maximum consecutive losers in all simulator runs.",lossStrike),createBlock("Max Win Strike","Maximum consecutive winners in all simulator runs.",winStrike),isFile&&(createBlock("Average Win","The weighted average of all profit trades in the uploaded trade list.",(100*avgW).toFixed(2)+"%"),createBlock("Average Loss","The weighted average of all loss trades in the uploaded trade list.",(100*avgL).toFixed(2)+"%"),createBlock("Hitrate","Hitrate, based on the trades in your file. Winning trades / Sum of trades.",(100*hr).toFixed(2)+"%"),createBlock("StD Loss Trades","Standard deviation of loss trades in the uploaded trade list. The higher the more diverging the positive trade results.",stdL.toFixed(2)+"%"),createBlock("StD Profit Trades","Standard deviation of profit trades in the uploaded trade list. The higher the more diverging the negative trade results.",stdW.toFixed(2)+"%")),md>0)if(Math.floor(o)-1>md){let e;let t;diffR=100*(100*avgL-avgL*(md/o)*100)/(100*avgL);let a=nHR(md,avgW/avgL);diffHR=Math.abs(100*hr-a)/hr/Math.pow(1/(100*avgL),2)/100,a=isFile?hr*(1+(diffHR/=1e4))*100:hr*(1+diffHR)*100,textOutSugg(a),addChangeListen()}else $jq(".textOut").empty(),$jq(".textOut").append("You won't exceed your maximum drawdown!")}function textOutSugg(e){let t='<input id="ChangeSR" type="button" value="Change Settings"/><input id="RerunR" type="button" value="Rerun"/>';let a='<input id="ChangeSHR" type="button" value="Change Settings"/><input id="RerunHR" type="button" value="Rerun"/>';$jq(".textOut").append("<p>You will violate your maximum drawdown allowance. Change one of these things to not exceed it:</p>"),$jq(".textOut").append("<p><i>1st Option:</i> Decrease your risk by "+diffR.toFixed(2)+"% "+t+"</p><p><i>2nd Option:</i> Increase your winning% by "+(100*diffHR).toFixed(2)+"% to <u>"+e.toFixed(2)+"%</u> "+a+"</p>")}function outPutNeg(){isFile?$jq(".textOut").append("Can't calculate. You have to fill in numbers in the numbers in the two blue fields."):$jq(".textOut").append("Can't calculate. You have to fill in numbers in the numbers in the gray fields.")}function uploadDealcsv(){}function addCSVEL(){uploadDealcsv.prototype.getCsv=function(e){let t;document.getElementById("my-file").addEventListener("change",(function(){if(this.files&&this.files[0]){var e=this.files[0];var t=new FileReader;t.addEventListener("load",(function(e){let t=e.target.result;parseCsv.getParsecsvdata(t)})),t.readAsBinaryString(e)}}))}}uploadDealcsv.prototype.getParsecsvdata=function(e){csv=[];let t=e.split("\n");for(let e=0;e<t.length;e++)csv.push(t[e].split(","));csvs=createCSVValues();let a=createStepTable(start);probT=createProbTable(csvs,a)};var parseCsv=new uploadDealcsv;function GaussianRand(){if(this.generate=!0,this.value0=0,this.value1=0,this.generate){var e=0;var t=0;var a=0;do{a=(e=2*Math.random()-1)*e+(t=2*Math.random()-1)*t}while(a>=1);a=Math.sqrt(-2*Math.log(a)/a),this.value0=e*a,this.value1=t*a,result=this.value0}else result=this.value1;return this.generate=!this.generate,result}let xCountlol=0;function randomTR(e,t){let a=t/100;const r=GaussianRand();return xCountlol<10,xCountlol++,r*a+e}function posAndNeg(e){let t=[];let a=[];for(let r in e)e[r]>=0?t.push(e[r]):a.push(e[r]);return[t,a]}function stD(e,t){let a;let r=average(e.map((function(e){let a=e-t;let r;return a*a})));let n;return Math.sqrt(r)}function average(e){let t;let a;return e.reduce((function(e,t){return e+t}),0)/e.length}function formatNumber(e){return e.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,",")}function formatCurrency(e,t){let a=e.val();if(""===a)return;let r=a.length;let n=e.prop("selectionStart");if(a.indexOf(".")>=0){var s=a.indexOf(".");var i=a.substring(0,s);var o=a.substring(s);i=formatNumber(i),o=formatNumber(o),"blur"===t&&(o+="00"),a=i+"."+(o=o.substring(0,2))}else a=formatNumber(a),a=a,"blur"===t&&(a+=".00");var l;e.val(a),n=a.length-r+n,e[0].setSelectionRange(n,n)}function nHR(e,t){let a;let r;switch(closest(t,rrN)){case.1:r=-2e-4*Math.pow(e,3)+.0249*Math.pow(e,2)-1.123*e+104.98;break;case.25:r=-2e-4*Math.pow(e,3)+.0283*Math.pow(e,2)-1.3844*e+102.28;break;case.5:r=-3e-4*Math.pow(e,3)+.0383*Math.pow(e,2)-1.9967*e+102.7;break;case.75:r=-3e-4*Math.pow(e,3)+.0436*Math.pow(e,2)-2.3583*e+102;break;case 1:r=-3e-4*Math.pow(e,3)+.0523*Math.pow(e,2)-2.8688*e+104.49;break;case 1.1:r=-3e-4*Math.pow(e,3)+.0501*Math.pow(e,2)-2.8211*e+103.64;break;case 1.25:r=-4e-4*Math.pow(e,3)+.0638*Math.pow(e,2)-3.3749*e+106.49;break;case 1.5:r=-3e-4*Math.pow(e,3)+.0554*Math.pow(e,2)-3.222*e+105.82;break;case 1.75:r=-4e-4*Math.pow(e,3)+.0679*Math.pow(e,2)-3.7769*e+109.47;break;case 2:r=-4e-4*Math.pow(e,3)+.0699*Math.pow(e,2)-3.9527*e+109.69;break;case 2.5:r=-3e-4*Math.pow(e,3)+.0539*Math.pow(e,2)-3.3105*e+101.61;break;case 3:r=-4e-4*Math.pow(e,3)+.0704*Math.pow(e,2)-4.1617*e+111.03;break;case 4:r=-4e-4*Math.pow(e,3)+.0714*Math.pow(e,2)-4.3016*e+111.63;break;case 5:r=-4e-4*Math.pow(e,3)+.0666*Math.pow(e,2)-4.1962*e+111.7;break;case 6:r=-4e-4*Math.pow(e,3)+.0739*Math.pow(e,2)-4.5293*e+113.2;break;case 10:r=-3e-4*Math.pow(e,3)+.0593*Math.pow(e,2)-4.0403*e+109.53;break}return r}function randColor(){var e;switch(Math.floor(53*Math.random())+1){case 1:return"rgb(0,255,255)";case 2:return"rgb(127,255,212)";case 3:return"rgb(0,0,255)";case 4:return"rgb(138,43,226)";case 5:return"rgb(165,42,42)";case 6:return"rgb(95,158,160)";case 7:return"rgb(127,255,0)";case 8:return"rgb(210,105,30)";case 9:return"rgb(255,127,80)";case 10:return"rgb(100,149,237)";case 11:return"rgb(220,20,60)";case 12:return"rgb(0,255,255)";case 13:return"rgb(0,0,139)";case 14:return"rgb(0,100,0)";case 15:return"rgb(139,0,139)";case 16:return"rgb(85,107,47)";case 17:return"rgb(255,140,0)";case 18:return"rgb(153,50,204)";case 19:return"rgb(139,0,0)";case 20:return"rgb(72,61,139)";case 21:return"rgb(47,79,79)";case 22:return"rgb(148,0,211)";case 23:return"rgb(255,20,147)";case 24:return"rgb(0,191,255)";case 25:return"rgb(105,105,105)";case 26:return"rgb(30,144,255)";case 27:return"rgb(178,34,34)";case 28:return"rgb(34,139,34)";case 29:return"rgb(255,0,255)";case 30:return"rgb(255,215,0)";case 31:return"rgb(218,165,32)";case 32:return"rgb(0,128,0)";case 33:return"rgb(173,255,47)";case 34:return"rgb(255,105,180)";case 35:return"rgb(205,92,92)";case 36:return"rgb(75,0,130)";case 37:return"rgb(124,252,0)";case 38:return"rgb(0,255,0)";case 39:return"rgb(255,0,255)";case 40:return"rgb(128,0,0)";case 41:return"rgb(0,0,205)";case 42:return"rgb(25,25,112)";case 43:return"rgb(199,21,133)";case 44:return"rgb(255,69,0)";case 45:return"rgb(255,165,0)";case 46:return"rgb(255,0,0)";case 47:return"rgb(65,105,225)";case 48:return"rgb(139,69,19)";case 49:return"rgb(160,82,45)";case 50:return"rgb(0,128,128)";case 51:return"rgb(70,130,180)";case 52:return"rgb(255,99,71)";case 53:return"rgb(238,130,238)"}}$jq((function(){var e;$jq(document).on("focus","input",(function(){e!=this&&(e=this,setTimeout((function(){e.select()}),50))}))})),$jq("input[data-type='currency']").on({keyup:function(){formatCurrency($jq(this))},blur:function(){formatCurrency($jq(this),"blur")}}),$jq(document).ready((function(){$jq("input[data-type='number']").keypress((function(e){if(8!=e.which&&0!==e.which&&(e.which<48||e.which>57))return!1}))}));
//# sourceMappingURL=/s/files/1/0534/4424/7743/t/1/assets/wp_rs.js.map?v=13276824427710539472
